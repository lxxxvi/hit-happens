<!DOCTYPE html>
<html><head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>SRF3: The Weeknd &#39;Blinding Lights&#39; - Verteilung der Plays während des Tages - Hit Happens</title><meta name="viewport" content="width=device-width, initial-scale=1">

	<meta property="og:description" content="Wann wird das Lied auf SRF3 wie oft gespielt?" />
	<meta name="twitter:description" content="Wann wird das Lied auf SRF3 wie oft gespielt?" />
	<meta name="description" content="Wann wird das Lied auf SRF3 wie oft gespielt?" />
	<meta name="description" content="Wann wird das Lied auf SRF3 wie oft gespielt?" />

	<meta property="og:title" content="SRF3: The Weeknd &#39;Blinding Lights&#39; - Verteilung der Plays während des Tages | Hit Happens" />
	<meta name="twitter:title" content="SRF3: The Weeknd &#39;Blinding Lights&#39; - Verteilung der Plays während des Tages | Hit Happens" />

	<meta property="og:image" content=""/>
	<meta itemprop="name" content="SRF3: The Weeknd &#39;Blinding Lights&#39; - Verteilung der Plays während des Tages | Hit Happens" />
	<meta name="application-name" content="SRF3: The Weeknd &#39;Blinding Lights&#39; - Verteilung der Plays während des Tages | Hit Happens" />
	<meta property="og:site_name" content="" />
	<meta property="og:title" content="SRF3: The Weeknd &#39;Blinding Lights&#39; - Verteilung der Plays während des Tages" />
<meta property="og:description" content="Wann wird das Lied auf SRF3 wie oft gespielt?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lxxxvi.github.io/hit-happens/posts/weeknd-blinding-lights-plays-in-tagesstunde/" />
<meta property="article:published_time" content="2020-09-16T15:11:31+02:00" />
<meta property="article:modified_time" content="2020-09-16T15:11:31+02:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SRF3: The Weeknd &#39;Blinding Lights&#39; - Verteilung der Plays während des Tages"/>
<meta name="twitter:description" content="Wann wird das Lied auf SRF3 wie oft gespielt?"/>
<script src="https://lxxxvi.github.io/hit-happens/js/feather.min.js"></script>
	
	<link href="https://fonts.googleapis.com/css2?family=Fira+Sans&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
	<link rel="stylesheet" type="text/css" media="screen" href="https://lxxxvi.github.io/hit-happens/css/main.css" />
</head><body>
        <div class="content"><header>
	<div class="main">
		<a href="https://lxxxvi.github.io/hit-happens/">Hit Happens</a>
	</div>
	<nav>
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">SRF3: The Weeknd &#39;Blinding Lights&#39; - Verteilung der Plays während des Tages</h1>
			<div class="meta">Posted on Sep 16, 2020</div>
		</div>
		

		<section class="body">
			<p><strong>Station: SRF3</strong></p>
<p><em>&ldquo;Blinding Lights&rdquo;</em> von The Weeknd wird auf SRF3 am häufigsten zwischen 15:00 Uhr und 16:00 Uhr gespielt.</p>
<p><img src="image.png" alt="The Weeknd Blinding Lights - Verteilung der Plays während des Tages"></p>
<p>Fügen wir die Dimension &ldquo;Wochentage&rdquo; in diese Rechnung ein, sehen wir dass der grossteil der Plays zwischen 15 Uhr und 16 Uhr am Sonntag stattfindet. Am Sonntag zu dieser Zeit wird auf SRF3 die offizielle Hitparade der Schweiz ausgestrahlt. Der Song war in der Schweiz für 13 Wochen auf Platz 1.</p>
<p><img src="pivot.png" alt="The Weeknd Blinding Lights - Verteilung der Plays der ganzen Woche"></p>
<hr>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/5lycM4LF7DM" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<hr>
<p>SQL Query für die Datenaufbereitung (Postgres 12)</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#00a8c8">WITH</span> <span style="color:#111">song</span> <span style="color:#00a8c8">AS</span> <span style="color:#111">(</span>
  <span style="color:#00a8c8">SELECT</span> <span style="color:#111">s</span><span style="color:#111">.</span><span style="color:#111">id</span>
    <span style="color:#00a8c8">FROM</span> <span style="color:#111">artists</span> <span style="color:#111">a</span>
   <span style="color:#00a8c8">INNER</span> <span style="color:#00a8c8">JOIN</span> <span style="color:#111">songs</span> <span style="color:#111">s</span> <span style="color:#00a8c8">ON</span> <span style="color:#111">s</span><span style="color:#111">.</span><span style="color:#111">artist_id</span> <span style="color:#f92672">=</span> <span style="color:#111">a</span><span style="color:#111">.</span><span style="color:#111">id</span>
   <span style="color:#00a8c8">WHERE</span> <span style="color:#00a8c8">upper</span><span style="color:#111">(</span><span style="color:#111">a</span><span style="color:#111">.</span><span style="color:#111">name</span><span style="color:#111">)</span>  <span style="color:#00a8c8">LIKE</span> <span style="color:#d88200">&#39;%WEEKND%&#39;</span>
     <span style="color:#00a8c8">AND</span> <span style="color:#00a8c8">upper</span><span style="color:#111">(</span><span style="color:#111">s</span><span style="color:#111">.</span><span style="color:#111">title</span><span style="color:#111">)</span> <span style="color:#00a8c8">LIKE</span> <span style="color:#d88200">&#39;%BLINDING LIGHTS%&#39;</span>
<span style="color:#111">),</span>

<span style="color:#111">broadcasts_with_tz</span> <span style="color:#00a8c8">AS</span> <span style="color:#111">(</span>
  <span style="color:#00a8c8">SELECT</span> <span style="color:#111">song_id</span>
       <span style="color:#111">,</span> <span style="color:#111">broadcasted_at</span> <span style="color:#00a8c8">AT</span> <span style="color:#111">TIME</span> <span style="color:#00a8c8">ZONE</span> <span style="color:#d88200">&#39;UTC&#39;</span> <span style="color:#00a8c8">AT</span> <span style="color:#111">TIME</span> <span style="color:#00a8c8">ZONE</span> <span style="color:#d88200">&#39;Europe/Zurich&#39;</span> <span style="color:#00a8c8">AS</span> <span style="color:#111">broadcasted_at_tz</span>
    <span style="color:#00a8c8">FROM</span> <span style="color:#111">cleaned_broadcasts</span>
   <span style="color:#00a8c8">WHERE</span> <span style="color:#111">song_id</span> <span style="color:#f92672">=</span> <span style="color:#111">(</span><span style="color:#00a8c8">SELECT</span> <span style="color:#111">id</span> <span style="color:#00a8c8">FROM</span> <span style="color:#111">song</span><span style="color:#111">)</span>
 <span style="color:#111">),</span>

<span style="color:#111">days</span> <span style="color:#00a8c8">AS</span> <span style="color:#111">(</span>
  <span style="color:#00a8c8">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#00a8c8">FROM</span>
    <span style="color:#111">(</span><span style="color:#00a8c8">VALUES</span>
      <span style="color:#111">(</span><span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;Montag&#39;</span><span style="color:#111">)</span>
    <span style="color:#111">,</span> <span style="color:#111">(</span><span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;Dienstag&#39;</span><span style="color:#111">)</span>
    <span style="color:#111">,</span> <span style="color:#111">(</span><span style="color:#ae81ff">2</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;Mittwoch&#39;</span><span style="color:#111">)</span>
    <span style="color:#111">,</span> <span style="color:#111">(</span><span style="color:#ae81ff">3</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;Donnerstag&#39;</span><span style="color:#111">)</span>
    <span style="color:#111">,</span> <span style="color:#111">(</span><span style="color:#ae81ff">4</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;Freitag&#39;</span><span style="color:#111">)</span>
    <span style="color:#111">,</span> <span style="color:#111">(</span><span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;Samstag&#39;</span><span style="color:#111">)</span>
    <span style="color:#111">,</span> <span style="color:#111">(</span><span style="color:#ae81ff">6</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;Sonntag&#39;</span><span style="color:#111">)</span>
    <span style="color:#111">)</span> <span style="color:#00a8c8">AS</span> <span style="color:#111">t</span> <span style="color:#111">(</span><span style="color:#111">dow</span><span style="color:#111">,</span> <span style="color:#111">dow_name</span><span style="color:#111">)</span>
<span style="color:#111">),</span>

<span style="color:#111">hours</span> <span style="color:#00a8c8">AS</span> <span style="color:#111">(</span>
  <span style="color:#00a8c8">SELECT</span> <span style="color:#111">generate_series</span> <span style="color:#00a8c8">AS</span> <span style="color:#111">hour</span>
    <span style="color:#00a8c8">FROM</span> <span style="color:#111">generate_series</span><span style="color:#111">(</span><span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#ae81ff">23</span><span style="color:#111">)</span>
<span style="color:#111">),</span>

<span style="color:#111">all_dow_and_hours</span> <span style="color:#00a8c8">AS</span> <span style="color:#111">(</span>
  <span style="color:#00a8c8">SELECT</span> <span style="color:#111">d</span><span style="color:#111">.</span><span style="color:#111">dow</span>
       <span style="color:#111">,</span> <span style="color:#111">h</span><span style="color:#111">.</span><span style="color:#111">hour</span>
    <span style="color:#00a8c8">FROM</span> <span style="color:#111">days</span> <span style="color:#111">d</span>
   <span style="color:#00a8c8">CROSS</span> <span style="color:#00a8c8">JOIN</span> <span style="color:#111">hours</span> <span style="color:#111">h</span>
 <span style="color:#111">),</span>

<span style="color:#111">grouped_by_dow_and_hour</span> <span style="color:#00a8c8">AS</span> <span style="color:#111">(</span>
  <span style="color:#00a8c8">SELECT</span> <span style="color:#111">(</span><span style="color:#00a8c8">EXTRACT</span><span style="color:#111">(</span><span style="color:#111">dow</span> <span style="color:#00a8c8">FROM</span> <span style="color:#111">broadcasted_at_tz</span><span style="color:#111">)</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">6</span><span style="color:#111">)::</span><span style="color:#111">INT</span> <span style="color:#f92672">%</span> <span style="color:#ae81ff">7</span> <span style="color:#00a8c8">AS</span> <span style="color:#111">dow</span>
       <span style="color:#111">,</span> <span style="color:#00a8c8">EXTRACT</span><span style="color:#111">(</span><span style="color:#111">hour</span> <span style="color:#00a8c8">FROM</span> <span style="color:#111">broadcasted_at_tz</span><span style="color:#111">)</span>               <span style="color:#00a8c8">AS</span> <span style="color:#111">hour</span>
       <span style="color:#111">,</span> <span style="color:#00a8c8">count</span><span style="color:#111">(</span><span style="color:#f92672">*</span><span style="color:#111">)</span>                                           <span style="color:#00a8c8">AS</span> <span style="color:#111">plays</span>
    <span style="color:#00a8c8">FROM</span> <span style="color:#111">broadcasts_with_tz</span>
   <span style="color:#00a8c8">GROUP</span> <span style="color:#00a8c8">BY</span> <span style="color:#00a8c8">EXTRACT</span><span style="color:#111">(</span><span style="color:#111">hour</span> <span style="color:#00a8c8">FROM</span> <span style="color:#111">broadcasted_at_tz</span><span style="color:#111">)</span>
          <span style="color:#111">,</span> <span style="color:#00a8c8">EXTRACT</span><span style="color:#111">(</span><span style="color:#111">dow</span> <span style="color:#00a8c8">FROM</span> <span style="color:#111">broadcasted_at_tz</span><span style="color:#111">)</span>
<span style="color:#111">)</span>

<span style="color:#00a8c8">SELECT</span> <span style="color:#111">dh</span><span style="color:#111">.</span><span style="color:#111">dow</span> <span style="color:#f92672">||</span> <span style="color:#d88200">&#39; - &#39;</span> <span style="color:#f92672">||</span> <span style="color:#111">d</span><span style="color:#111">.</span><span style="color:#111">dow_name</span>   <span style="color:#00a8c8">AS</span> <span style="color:#111">dow_name</span>
     <span style="color:#111">,</span> <span style="color:#111">dh</span><span style="color:#111">.</span><span style="color:#111">hour</span>                         <span style="color:#00a8c8">AS</span> <span style="color:#111">hour</span>
     <span style="color:#111">,</span> <span style="color:#111">COALESCE</span><span style="color:#111">(</span><span style="color:#111">b</span><span style="color:#111">.</span><span style="color:#111">plays</span><span style="color:#111">,</span> <span style="color:#ae81ff">0</span><span style="color:#111">)</span>            <span style="color:#00a8c8">AS</span> <span style="color:#111">plays</span>
  <span style="color:#00a8c8">FROM</span> <span style="color:#111">all_dow_and_hours</span> <span style="color:#111">dh</span>
  <span style="color:#00a8c8">LEFT</span> <span style="color:#00a8c8">OUTER</span> <span style="color:#00a8c8">JOIN</span> <span style="color:#111">grouped_by_dow_and_hour</span> <span style="color:#111">b</span> <span style="color:#00a8c8">ON</span> <span style="color:#111">b</span><span style="color:#111">.</span><span style="color:#111">hour</span> <span style="color:#f92672">=</span> <span style="color:#111">dh</span><span style="color:#111">.</span><span style="color:#111">hour</span> 
                                           <span style="color:#00a8c8">AND</span> <span style="color:#111">b</span><span style="color:#111">.</span><span style="color:#111">dow</span> <span style="color:#f92672">=</span> <span style="color:#111">dh</span><span style="color:#111">.</span><span style="color:#111">dow</span>
  <span style="color:#00a8c8">INNER</span> <span style="color:#00a8c8">JOIN</span> <span style="color:#111">days</span> <span style="color:#111">d</span> <span style="color:#00a8c8">ON</span> <span style="color:#111">dh</span><span style="color:#111">.</span><span style="color:#111">dow</span> <span style="color:#f92672">=</span> <span style="color:#111">d</span><span style="color:#111">.</span><span style="color:#111">dow</span>
  <span style="color:#00a8c8">ORDER</span> <span style="color:#00a8c8">BY</span> <span style="color:#111">dh</span><span style="color:#111">.</span><span style="color:#111">dow</span><span style="color:#111">,</span> <span style="color:#111">dh</span><span style="color:#111">.</span><span style="color:#111">hour</span>
</code></pre></div>
		</section>

		<div class="post-tags">
			
			
			
		</div>
	</article>
</main>
<footer>
<hr><a class="soc" href="https://twitter.com/marioschuettel/" title="Twitter"><i data-feather="twitter"></i></a>|⚡️
	2020  <a href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
</footer>


<script>
      feather.replace()
</script></div>
    </body>
</html>
